clc; clear
Cs = @(C) sum(cat(3, C{:}), 3);
Cp = @(C) prod(cat(3, C{:}), 3);
L = @(x,y,v) ...
    ((7/10) + (3/2).*exp(-exp(400.*(y - 27/100))).*(y + 1/5).^2).*x ...
    + exp(-exp(400.*(y - 3/10))).*((3/10).*(y - 3/10).^2 + cos(5.*y + 6.*x + v)./20);
R = @(x,y,v) exp( - exp( -50.*(  sin(v + 30.*acos( ...
    (9/5).*L(x,y,v).*(0.5 + (1/pi).*atan(-180.*abs(L(x,y,v)) + 100)))) ...
    + 1/50 - y.^6./10 + (2/pi).*atan(200.*(y - 1/4)))) ...
    - exp(1000.*((9/5).*abs(L(x,y,v)) - 9/10)) ...
    - exp(100.*y - 25));
Q = @(x,y,s) y - (10 - s)./30 + 1/5 - x.^2 + cos(8.*x + 5.*s)./10;
P = @(x,y,s) Q(x,y,s) + Cs(arrayfun(@(u) ...
    (50 - s)./1000.*(3/5).^u.*atan( 3.*cos( ...
    2.^u.*(1 + s).*atan(1000.*x./(250.*(2.*y - 1).^2 + 1)) ...
     + 0.5.*(7/5).^u.*cos(2.^u.*(5 + s).*Q(x,y,s)) + 2.*u.*s)), 0:7, 'UniformOutput',false));
J = @(x,y,s) ...
    exp(-exp(500.*(abs(x + ((40 - s)./40.*cos(8.*s) + 1/2).*(y - 1/2).^2) ...
    - pi/15 - (3/20).*atan(-8.*(y - (10 - s)./30)))) ...
    - exp(-200.*P(x,y,s)) - exp(1000.*(y - 7/10)));
T = @(x,y,s) ...
    cos((23.^s.*20.^(-s).*10.*(1 + cos(10.*s))).* ...
        (cos(7.*s).*x + sin(7.*s).*y + 2*cos(17.*s)) + ...
        4*cos((23.^s.*20.^(-s).*10).*(cos(7.*s).*x + sin(7.*s).*y)) + ...
        2*cos(5.*s)).* ...
    cos((23.^s.*20.^(-s).*10.*(1 + cos(10.*s))).* ...
        (cos(7.*s).*y - sin(7.*s).*x + 2*cos(15.*s)) + ...
        4*cos((23.^s.*20.^(-s).*10).*(cos(8.*s).*x + sin(8.*s).*y)) + ...
        2*cos(7.*s));
E = @(x,y) Cs(arrayfun(@(s) 3.*(25.^s./26.^s).*T(x,y,s)./10, 1:50, 'UniformOutput',false));
C = @(x,y) Cs(arrayfun(@(s) ...
    Cp(arrayfun(@(u) 1 - (3/4).*exp(-exp(-100.*(u - 1/2))).*J(x,y,u), 0:s-1, 'UniformOutput',false)) ...
    .* J(x,y,s) ...
    .* (exp(-exp(3.*(y - (10 - s)./30 + 1/5 - x.^2 + cos(8.*x + 5.*s)./10))) ...
    + (2/5).*exp(-exp(20.*abs(P(x,y,s)) - 1 + E(x,y)./5)) ...
    + (2/5).*exp(-exp(100.*abs(P(x,y,s)) - 3 + E(x,y)))), 1:35, 'UniformOutput',false));
U = @(x,y) 9/20 ...
    + 2.*exp(-exp(14.*(abs(abs(x).^(137/20 - 5.*y) + 2.*(y - 57/100).^2 - 27/100) - 1/25 + E(x,y)./100))) ...
    + (3/5).*exp(-exp(abs(20.*abs(x).^(13/2 - 5.*y) + 2.*(y - 1/2).^2 - 3/20) - 4/5 + E(x,y)./5)) ...
    + (1/5).*exp(-exp(100.*(abs(x).^(13/2 - 5.*y) + 2.*(y - 1/2).^2 - 3/20)));
W = @(x,y,v) exp(-exp(v.*(abs(x).^(7 - 5.*y) + 2.*(y - 3/5).^2 - 1/4)));
K = @(x,y) exp( - exp( ...
    cos(20.*x .* ((1/1000).*(abs(250 - 20.*(10.*y - 6).^2) + 1)).^(-1000./(1000.*abs(7 - 5.*y) + 1)))) + E(x,y)./3 );
H = @(x,y,v) ...
    ((19 - 21.*v + 7.*v.^2)./10) .* ( ...
        R(x,y,0) + R(x,y,1).*(1 - R(x,y,0)) .* ...
        Cp(arrayfun(@(s) 1 - (3/4).*J(x,y,s), 1:35, 'UniformOutput',false)) ) ...
    + (9.*v./40) .* (1 + 2.*y./3 - x.^2./20 + E(x,y)./20) ...
    + ((5 - 3.*v + v.^2)./5) .* C(x,y) .* (1 - R(x,y,0)) .* (1 - 3./5 .* W(x,y,500)) ...
    + ((5 - 3.*v + v.^2)./5) .* ( ...
        W(x,y,5) + y./4 - 3./20 + ...
        (3./10 - v./20 + (2 - v)./5 .* (y - 2./5)) .* K(x,y) + ...
        (8 - 7.*v)./20 .* exp(-exp(10.*y - 5 + E(x,y)))) .* W(x,y,500) .* U(x,y);
F = @(x) floor(255 .* exp(-exp(-1000 .* x)) .* abs(x).^exp(-exp(1000 .* (x - 1))));
[m,n] = meshgrid(1:0.75:2000, 1:0.75:1200);
Rp = uint8(F(H((m - 1000)./600, (651 - n)./600, 0)));
Gp = uint8(F(H((m - 1000)./600, (651 - n)./600, 1)));
Bp = uint8(F(H((m - 1000)./600, (651 - n)./600, 2)));
Pp = cat(3, Rp, Gp, Bp);
imshow(Pp)