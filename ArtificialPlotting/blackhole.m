clc; clear
Cs = @(C) sum(cat(3, C{:}), 3);
Cp = @(C) prod(cat(3, C{:}), 3);
L = @(x,y) Cs(arrayfun(@(u) 2*exp(-exp(-70*( ...
    cos((2 + u.^5/30).*(cos(4*u.^2).*x/4 + sin(4*u.^2).*y/4) + u.^2 + u.^4).^10 ...
  .* cos((2 + u.^(6/5)/30).*(sin(4*u.^2).*x/4 - cos(4*u.^2).*y/4) + u.^2 + u.^4).^10 ...
  - 1 + 3/200*u.^(-23/20) ))), 1:200, 'UniformOutput', false));
Q = @(x,y) (3/10)*x + (3/20)*y;
P = @(x,y) y - x/2;
E = @(x,y) sqrt(((3/10)*x + (3/20)*y).^2 + (y - x/2).^2) ...
    .* exp(-exp(-(20 + 40*(0.5 + (1/pi)*atan(-10000*(y - x/2)))) ...
    .* (sqrt((10/3 - (7/3)*(0.5 + (1/pi)*atan(-10000*(y - x/2)))).^2 ...
    .* ((3/10)*x + (3/20)*y).^2 + (y - x/2).^2) - 1.5 + (21/20)*(0.5 + (1/pi)*atan(-10000*(y - x/2))))));
J = @(x,y,r) exp(-7*((Q(x,y)-E(x,y).*cos(pi*r/4 - 9/2*log(E(x,y)))).^2 + ...
    (P(x,y)-E(x,y).*sin(pi*r/4 - 9/2*log(E(x,y)))).^2) - exp(10*(E(x,y) - ...
    13/10*abs(cos(r.^4)) - 1/5).^2 - 2));
K = @(x,y) Cs(arrayfun(@(s) (4/25).*exp(-exp(-100.*(...
       cos(((5+s/6)*(cos(s^2).*x+sin(s^2).*y)+10*sin(10*s))).^10 ...
    .* cos(((5+s/6)*(sin(s^2).*x-cos(s^2).*y)+10*sin(17*s))).^10 - 0.5))), 1:70, 'UniformOutput', false));
A = @(x,y) Cs(arrayfun(@(r) cos(7*r).^2 .*J(x,y,r), 1:50, 'UniformOutput', false));
W = @(x,y) exp(-exp(20*(abs(x + y/2 + 3/50*cos(10*(y - x/2) + 3*cos(7*y - 7*x/2))) ...
    - 3/100 - 3/250*(y - x/2).^2)) - exp(1000*(y - x/2)));
R = @(x,y) exp(-exp(20*(abs(x + y/2 + 3/50*cos(10*(y - x/2) + 3*cos(7*y - 7*x/2))) ...
    - 3/100 - 3/250*(y - x/2).^2)) - exp(-1000*(y - x/2 - 3/2)));
H = @(x,y,v) (3*v.^2 - 5*v + 7)/4 .* R(x,y) .* K(x,y) + (2 - v)/2 .* A(x,y) .* K(x,y) .* (1 - R(x,y)) ...
    .* exp(-exp(-20*((x - 17/10).^2 + (y - 2/5).^2 - 3/100)) - exp(-20*((x + 5/2).^2 + (y + 4/5).^2 - 1/50))) ...
    + (23*v.^2 - 38*v + 55)/20 .* exp(-exp(15*(x - 17/10).^2 + 15*(y - 2/5).^2 - 45/100)) ...
    + ((3*v.^2 - 5*v + 7)/4 .* W(x,y) .* K(x,y) + (14 + 3*v.^2 - 3*v)/20 .* L(x,y) .* (1 - W(x,y)) .* (1 - R(x,y))) ...
    .* Cp(arrayfun(@(r) 1 - J(x,y,r), 1:50, 'UniformOutput', false)) ...
    .* exp(-exp(-2*(3/10*x + 3/20*y).^2 - 18/10*(y - x/2).^2 + 64/10)) ...
    + (25 - 12*v + 2*v.^2)/6 .* exp(-exp(20*((x + 5/2).^2 + (y + 4/5).^2 - 1/50)));
F = @(x) floor(255 .* exp(-exp(-1000 .* x)) .* abs(x).^exp(-exp(1000 .* (x - 1))));
[m,n] = meshgrid(1:0.5:2000, 1:0.5:1200);
Rp = uint8(F(H((m - 1000)./160, (601 - n)./160, 0)));
Gp = uint8(F(H((m - 1000)./160, (601 - n)./160, 1)));
Bp = uint8(F(H((m - 1000)./160, (601 - n)./160, 2)));
Pp = cat(3, Rp, Gp, Bp);
imshow(Pp)