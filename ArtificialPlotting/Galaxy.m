clc; clear
Cs = @(C) sum(cat(3, C{:}), 3);
Cp = @(C) prod(cat(3, C{:}), 3);
E = @(x,y,s) Cs(arrayfun(@(k) exp(-exp(100*(x.^2 + y.^2 - 40/k))) ...
    .* (cos((3 + k./(12 + s)).*x + k.*y./20 + k.^(3 + s)).^(1000 + 8*k)) ...
    .* (cos((3 + s + k./(12 + s)).*y - k.*x./20 + k.^(4 + s)).^(1000 + 8*k)), 1:60, 'UniformOutput', false));
C = @(x,y,s) Cs(arrayfun(@(k) (cos((7 - 2*s + k./(2 + s)).*x + k.^(3 + s)).^(50 + 8*k)) ...
    .* (cos((7 - 2*s + k./(2 + s)).*y + k.^(4 + s)).^(50 + 8*k)), 1:100, 'UniformOutput', false));
A = @(x,y) Cp(arrayfun(@(k) 1 - exp(-exp(10*(sqrt(x.^2 + y.^2) - 1.3*cos(k^4).^2).^2 - 1)) ...
.* exp(-14*((x - sqrt(x.^2 + y.^2).*cos(2*pi*k/8 - 2.5*log(sqrt(x.^2 + y.^2 + 0.1*abs(cos(15*sqrt(x.^2 + y.^2))))))).^2 ...
+ (y - sqrt(x.^2 + y.^2).*sin(2*pi*k/8 - 2.5*log(sqrt(x.^2 + y.^2 + 0.1*abs(cos(15*sqrt(x.^2 + y.^2))))))).^2)), 1:14, 'UniformOutput', false));
R = @(x,y) 0.5*(2 - sqrt(x.^2 + y.^2)).*(1 + 0.2*exp(-4*(x.^2 + y.^2)) - A(x,y)) ...
    .* (1 + C(x,y,1) + 0.4*C(x,y,2) + C(x,y,3)) + E(x,y,1) + 0.8*E(x,y,2) + E(x,y,3);
G = @(x,y) 0.5*(2 - sqrt(x.^2 + y.^2)).*(1 + 0.2*exp(-4*(x.^2 + y.^2)) - A(x,y)) ...
    .* (1 + C(x,y,1) + 0.4*C(x,y,2) + 0.4*C(x,y,3)) + E(x,y,1) + 0.8*E(x,y,2) + 0.8*E(x,y,3);
B = @(x,y) 0.5*(2 - sqrt(x.^2 + y.^2)).*(1 + 0.2*exp(-4*(x.^2 + y.^2)) - A(x,y)) ...
    .* (1 + 0.4*C(x,y,1) + C(x,y,2) + 0.4*C(x,y,3)) + 0.8*E(x,y,1) + E(x,y,2) + 0.8*E(x,y,3);
F = @(x) floor(255 .* exp(-exp(-1000 .* x)) .* abs(x).^exp(-exp(1000 .* (x - 1))));
[m,n] = meshgrid(1:1:2000, 1:1:1200);
Rp = uint8(F(R((m - 1000)./400, (601 - n)./400)));
Gp = uint8(F(G((m - 1000)./400, (601 - n)./400)));
Bp = uint8(F(B((m - 1000)./400, (601 - n)./400)));
Pp = cat(3, Rp, Gp, Bp);
imshow(Pp)